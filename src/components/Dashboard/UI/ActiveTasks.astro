---
import { supabase } from "../../../utils/supabase";
import ActiveTaskCount from "./ActiveTaskCount.jsx";

// Get initial count for SSR
const { count, error } = await supabase
  .from("todotasks")
  .select("*", { count: "exact" })
  .in("status", ["progress", "todo"]);

if (error) {
  console.error(error);
}
---

<div
  class="bg-[var(--color-panel)] border border-[var(--gray-a6)] rounded-[var(--radius-3)] p-6 shadow-sm"
>
  <div class="flex items-center justify-between">
    <div>
      <p class="text-sm text-[var(--gray-11)] mb-1">Active Tasks</p>
      <ActiveTaskCount initialCount={count ?? 0} client:load />
    </div>
    <div
      class="w-12 h-12 bg-[var(--accent-a3)] rounded-[var(--radius-2)] flex items-center justify-center"
    >
      <svg
        width="20"
        height="20"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        class="text-[var(--accent-11)]"
      >
        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
    </div>
  </div>
</div>
