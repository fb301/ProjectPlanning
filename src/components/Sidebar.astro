---
import {
  DashboardIcon,
  FileTextIcon,
  LayoutIcon,
  HamburgerMenuIcon,
  RocketIcon,
  ActivityLogIcon, // Ny ikon importeras
} from "@radix-ui/react-icons";
---

<aside
  class="fixed inset-y-0 left-0 z-30 w-16 transition-all duration-300 bg-[var(--gray-2)] border-r border-[var(--gray-a5)] shadow-lg group md:flex"
  id="sidebar"
  data-expanded="false"
>
  <div class="flex flex-col h-full">
    <button class="menu-button flex items-center p-4 hover:bg-[var(--gray-a3)]">
      <HamburgerMenuIcon width="24" height="24" />
    </button>

    <nav class="flex-1 px-2 py-4 space-y-2">
      <a
        href="/"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Dashboard"
      >
        <DashboardIcon width="24" height="24" />
      </a>
      <a
        href="/kanban"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Kanban Board"
      >
        <LayoutIcon width="24" height="24" />
      </a>
      <a
        href="/taskform"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Taskform"
      >
        <FileTextIcon width="24" height="24" />
      </a>
      <a
        href="/ganttpage"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Gantt"
      >
        <ActivityLogIcon width="24" height="24" />
        <a
          href="/landingpage"
          class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
          data-label="Landningssida"
        >
          <RocketIcon width="24" height="24" />
        </a>
      </a>
    </nav>
  </div>

  <script>
    const menuButton = document.querySelector(".menu-button");
    const sidebar = document.getElementById("sidebar");
    const sidebarItems = document.querySelectorAll(".sidebar-item");

    menuButton?.addEventListener("click", () => {
      if (!sidebar) return;

      const isExpanded = sidebar.dataset.expanded === "true";

      if (isExpanded) {
        sidebar.classList.remove("w-64");
        sidebar.classList.add("w-16");
        sidebar.dataset.expanded = "false";

        sidebarItems.forEach((item) => {
          const existingSpan = item.querySelector("span");
          if (existingSpan) {
            existingSpan.remove();
          }
        });
      } else {
        sidebar.classList.remove("w-16");
        sidebar.classList.add("w-64");
        sidebar.dataset.expanded = "true";

        setTimeout(() => {
          sidebarItems.forEach((item) => {
            const htmlItem = item as HTMLElement;
            const labelText = htmlItem.dataset.label;
            if (labelText && !item.querySelector("span")) {
              const span = document.createElement("span");
              span.className = "ml-3 whitespace-nowrap";
              span.textContent = labelText;
              item.appendChild(span);
            }
          });
        }, 150);
      }
    });
  </script>
</aside>
