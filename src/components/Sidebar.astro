---
import {
  FaceIcon,
  ImageIcon,
  SunIcon,
  HamburgerMenuIcon,
} from "@radix-ui/react-icons";
---

<aside
  class="fixed inset-y-0 left-0 z-30 w-16 transition-all duration-300 bg-[var(--color-panel)] border-r border-[var(--gray-a5)] shadow-lg group md:flex"
  id="sidebar"
  data-expanded="false"
>
  <div class="flex flex-col h-full">
    <button class="menu-button flex items-center p-4 hover:bg-[var(--gray-a3)]">
      <HamburgerMenuIcon width="24" height="24" />
    </button>

    <nav class="flex-1 px-2 py-4 space-y-2">
      <a
        href="#"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Home"
      >
        <FaceIcon width="24" height="24" />
      </a>
      <a
        href="#"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Kanban Board"
      >
        <SunIcon width="24" height="24" />
      </a>
      <a
        href="#"
        class="sidebar-item flex flex-grow items-center p-3 rounded-lg text-[var(--gray-12)] hover:bg-[var(--gray-a3)] transition-colors"
        data-label="Media"
      >
        <ImageIcon width="24" height="24" />
      </a>
    </nav>
  </div>
</aside>

<script>
  const menuButton = document.querySelector(".menu-button");
  const sidebar = document.getElementById("sidebar");
  const sidebarItems = document.querySelectorAll(".sidebar-item");

  menuButton?.addEventListener("click", () => {
    if (!sidebar) return;

    const isExpanded = sidebar.dataset.expanded === "true";

    if (isExpanded) {
      sidebar.classList.remove("w-64");
      sidebar.classList.add("w-16");
      sidebar.dataset.expanded = "false";

      sidebarItems.forEach((item) => {
        const existingSpan = item.querySelector("span");
        if (existingSpan) {
          existingSpan.remove();
        }
      });
    } else {
      sidebar.classList.remove("w-16");
      sidebar.classList.add("w-64");
      sidebar.dataset.expanded = "true";

      setTimeout(() => {
        sidebarItems.forEach((item) => {
          const htmlItem = item as HTMLElement;
          const labelText = htmlItem.dataset.label;
          if (labelText && !item.querySelector("span")) {
            const span = document.createElement("span");
            span.className = "ml-3 whitespace-nowrap";
            span.textContent = labelText;
            item.appendChild(span);
          }
        });
      }, 150);
    }
  });
</script>
